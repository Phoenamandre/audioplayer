function Animator(a){this.setOptions(a);var b=this;this.timerDelegate=function(){b.onTimerEvent()},this.subjects=[],this.subjectScopes=[],this.target=0,this.state=0,this.lastTime=null}function NumericalStyleSubject(a,b,c,d,e){this.els=Animator.makeArray(a),"opacity"==b&&window.ActiveXObject?this.property="filter":this.property=Animator.camelize(b),this.from=parseFloat(c),this.to=parseFloat(d),this.units=null!=e?e:"px"}function ColorStyleSubject(a,b,c,d){this.els=Animator.makeArray(a),this.property=Animator.camelize(b),this.to=this.expandColor(d),this.from=this.expandColor(c),this.origFrom=c,this.origTo=d}function DiscreteStyleSubject(a,b,c,d,e){this.els=Animator.makeArray(a),this.property=Animator.camelize(b),this.from=c,this.to=d,this.threshold=e||.5}function CSSStyleSubject(a,b,c){if(a=Animator.makeArray(a),this.subjects=[],0!=a.length){var d,e,f;if(c)f=this.parseStyle(b,a[0]),e=this.parseStyle(c,a[0]);else{e=this.parseStyle(b,a[0]),f={};for(d in e)f[d]=CSSStyleSubject.getStyle(a[0],d)}var d;for(d in f)f[d]==e[d]&&(delete f[d],delete e[d]);var d,g,h,i,j,k;for(d in f){var l=String(f[d]),m=String(e[d]);if(null!=e[d]){if(j=ColorStyleSubject.parseColor(l))k=ColorStyleSubject.parseColor(m),i=ColorStyleSubject;else if(l.match(CSSStyleSubject.numericalRe)&&m.match(CSSStyleSubject.numericalRe)){j=parseFloat(l),k=parseFloat(m),i=NumericalStyleSubject,h=CSSStyleSubject.numericalRe.exec(l);var n=CSSStyleSubject.numericalRe.exec(m);g=null!=h[1]?h[1]:null!=n[1]?n[1]:n}else{if(!l.match(CSSStyleSubject.discreteRe)||!m.match(CSSStyleSubject.discreteRe)){window.DEBUG&&alert("Unrecognised format for value of "+d+": '"+f[d]+"'");continue}j=l,k=m,i=DiscreteStyleSubject,g=0}this.subjects[this.subjects.length]=new i(a,d,j,k,g)}else window.DEBUG&&alert("No to style provided for '"+d+'"')}}}function AnimatorChain(a,b){this.animators=a,this.setOptions(b);for(var c=0;c<this.animators.length;c++)this.listenTo(this.animators[c]);this.forwards=!1,this.current=0}function Accordion(a){this.setOptions(a);var c,b=this.options.initialSection;this.options.rememberance&&(c=document.location.hash.substring(1)),this.rememberanceTexts=[],this.ans=[];for(var d=this,e=0;e<this.options.sections.length;e++){var f=this.options.sections[e],g=new Animator(this.options.animatorOptions),h=this.options.from+this.options.shift*e,i=this.options.to+this.options.shift*e;g.addSubject(new NumericalStyleSubject(f,this.options.property,h,i,this.options.units)),g.jumpTo(0);var j=this.options.getActivator(f);j.index=e,j.onclick=function(){d.show(this.index)},this.ans[this.ans.length]=g,this.rememberanceTexts[e]=j.innerHTML.replace(/\s/g,""),this.rememberanceTexts[e]===c&&(b=e)}this.show(b)}Animator.prototype={setOptions:function(a){this.options=Animator.applyDefaults({interval:20,duration:400,onComplete:function(){},onStep:function(){},transition:Animator.tx.easeInOut},a)},seekTo:function(a){this.seekFromTo(this.state,a)},seekFromTo:function(a,b){this.target=Math.max(0,Math.min(1,b)),this.state=Math.max(0,Math.min(1,a)),this.lastTime=(new Date).getTime(),this.intervalId||(this.intervalId=window.setInterval(this.timerDelegate,this.options.interval))},jumpTo:function(a){this.target=this.state=Math.max(0,Math.min(1,a)),this.propagate()},toggle:function(){this.seekTo(1-this.target)},addSubject:function(a,b){return this.subjects[this.subjects.length]=a,this.subjectScopes[this.subjectScopes.length]=b,this},clearSubjects:function(){this.subjects=[],this.subjectScopes=[]},propagate:function(){for(var a=this.options.transition(this.state),b=0;b<this.subjects.length;b++)this.subjects[b].setState?this.subjects[b].setState(a):this.subjects[b].apply(this.subjectScopes[b],[a])},onTimerEvent:function(){var a=(new Date).getTime(),b=a-this.lastTime;this.lastTime=a;var c=b/this.options.duration*(this.state<this.target?1:-1);Math.abs(c)>=Math.abs(this.state-this.target)?this.state=this.target:this.state+=c;try{this.propagate()}finally{this.options.onStep.call(this),this.target==this.state&&(window.clearInterval(this.intervalId),this.intervalId=null,this.options.onComplete.call(this))}},play:function(){this.seekFromTo(0,1)},reverse:function(){this.seekFromTo(1,0)},inspect:function(){for(var a="#<Animator:\n",b=0;b<this.subjects.length;b++)a+=this.subjects[b].inspect();return a+=">"}},Animator.applyDefaults=function(a,b){b=b||{};var c,d={};for(c in a)d[c]=void 0!==b[c]?b[c]:a[c];return d},Animator.makeArray=function(a){if(null==a)return[];if(!a.length)return[a];for(var b=[],c=0;c<a.length;c++)b[c]=a[c];return b},Animator.camelize=function(a){var b=a.split("-");if(1==b.length)return b[0];for(var c=0==a.indexOf("-")?b[0].charAt(0).toUpperCase()+b[0].substring(1):b[0],d=1,e=b.length;d<e;d++){var f=b[d];c+=f.charAt(0).toUpperCase()+f.substring(1)}return c},Animator.apply=function(a,b,c){return b instanceof Array?new Animator(c).addSubject(new CSSStyleSubject(a,b[0],b[1])):new Animator(c).addSubject(new CSSStyleSubject(a,b))},Animator.makeEaseIn=function(a){return function(b){return Math.pow(b,2*a)}},Animator.makeEaseOut=function(a){return function(b){return 1-Math.pow(1-b,2*a)}},Animator.makeElastic=function(a){return function(b){return b=Animator.tx.easeInOut(b),(1-Math.cos(b*Math.PI*a))*(1-b)+b}},Animator.makeADSR=function(a,b,c,d){return null==d&&(d=.5),function(e){return e<a?e/a:e<b?1-(e-a)/(b-a)*(1-d):e<c?d:d*(1-(e-c)/(1-c))}},Animator.makeBounce=function(a){var b=Animator.makeElastic(a);return function(a){return a=b(a),a<=1?a:2-a}},Animator.tx={easeInOut:function(a){return-Math.cos(a*Math.PI)/2+.5},linear:function(a){return a},easeIn:Animator.makeEaseIn(1.5),easeOut:Animator.makeEaseOut(1.5),strongEaseIn:Animator.makeEaseIn(2.5),strongEaseOut:Animator.makeEaseOut(2.5),elastic:Animator.makeElastic(1),veryElastic:Animator.makeElastic(3),bouncy:Animator.makeBounce(1),veryBouncy:Animator.makeBounce(3)},NumericalStyleSubject.prototype={setState:function(a){for(var b=this.getStyle(a),d=(this.property,0),e=0;e<this.els.length;e++){try{this.els[e].style[this.property]=b}catch(a){if("fontWeight"!=this.property)throw a}if(d++>20)return}},getStyle:function(a){return a=this.from+(this.to-this.from)*a,"filter"==this.property?"alpha(opacity="+Math.round(100*a)+")":"opacity"==this.property?a:Math.round(a)+this.units},inspect:function(){return"\t"+this.property+"("+this.from+this.units+" to "+this.to+this.units+")\n"}},ColorStyleSubject.prototype={expandColor:function(a){var b,c,d,e;if(b=ColorStyleSubject.parseColor(a))return c=parseInt(b.slice(1,3),16),d=parseInt(b.slice(3,5),16),e=parseInt(b.slice(5,7),16),[c,d,e];window.DEBUG&&alert("Invalid colour: '"+a+"'")},getValueForState:function(a,b){return Math.round(this.from[a]+(this.to[a]-this.from[a])*b)},setState:function(a){for(var b="#"+ColorStyleSubject.toColorPart(this.getValueForState(0,a))+ColorStyleSubject.toColorPart(this.getValueForState(1,a))+ColorStyleSubject.toColorPart(this.getValueForState(2,a)),c=0;c<this.els.length;c++)this.els[c].style[this.property]=b},inspect:function(){return"\t"+this.property+"("+this.origFrom+" to "+this.origTo+")\n"}},ColorStyleSubject.parseColor=function(a){var c,b="#";if(c=ColorStyleSubject.parseColor.rgbRe.exec(a)){for(var d,e=1;e<=3;e++)d=Math.max(0,Math.min(255,parseInt(c[e]))),b+=ColorStyleSubject.toColorPart(d);return b}if(c=ColorStyleSubject.parseColor.hexRe.exec(a)){if(3==c[1].length){for(var e=0;e<3;e++)b+=c[1].charAt(e)+c[1].charAt(e);return b}return"#"+c[1]}return!1},ColorStyleSubject.toColorPart=function(a){a>255&&(a=255);var b=a.toString(16);return a<16?"0"+b:b},ColorStyleSubject.parseColor.rgbRe=/^rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/i,ColorStyleSubject.parseColor.hexRe=/^\#([0-9a-fA-F]{3}|[0-9a-fA-F]{6})$/,DiscreteStyleSubject.prototype={setState:function(a){for(var c=0;c<this.els.length;c++)this.els[c].style[this.property]=a<=this.threshold?this.from:this.to},inspect:function(){return"\t"+this.property+"("+this.from+" to "+this.to+" @ "+this.threshold+")\n"}},CSSStyleSubject.prototype={parseStyle:function(a,b){var c={};if(-1!=a.indexOf(":"))for(var d=a.split(";"),e=0;e<d.length;e++){var f=CSSStyleSubject.ruleRe.exec(d[e]);f&&(c[f[1]]=f[2])}else{var g,h,i;i=b.className,b.className=a;for(var e=0;e<CSSStyleSubject.cssProperties.length;e++)g=CSSStyleSubject.cssProperties[e],null!=(h=CSSStyleSubject.getStyle(b,g))&&(c[g]=h);b.className=i}return c},setState:function(a){for(var b=0;b<this.subjects.length;b++)this.subjects[b].setState(a)},inspect:function(){for(var a="",b=0;b<this.subjects.length;b++)a+=this.subjects[b].inspect();return a}},CSSStyleSubject.getStyle=function(a,b){var c;return document.defaultView&&document.defaultView.getComputedStyle&&(c=document.defaultView.getComputedStyle(a,"").getPropertyValue(b))?c:(b=Animator.camelize(b),a.currentStyle&&(c=a.currentStyle[b]),c||a.style[b])},CSSStyleSubject.ruleRe=/^\s*([a-zA-Z\-]+)\s*:\s*(\S(.+\S)?)\s*$/,CSSStyleSubject.numericalRe=/^-?\d+(?:\.\d+)?(%|[a-zA-Z]{2})?$/,CSSStyleSubject.discreteRe=/^\w+$/,CSSStyleSubject.cssProperties=["azimuth","background","background-attachment","background-color","background-image","background-position","background-repeat","border-collapse","border-color","border-spacing","border-style","border-top","border-top-color","border-right-color","border-bottom-color","border-left-color","border-top-style","border-right-style","border-bottom-style","border-left-style","border-top-width","border-right-width","border-bottom-width","border-left-width","border-width","bottom","clear","clip","color","content","cursor","direction","display","elevation","empty-cells","css-float","font","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","height","left","letter-spacing","line-height","list-style","list-style-image","list-style-position","list-style-type","margin","margin-top","margin-right","margin-bottom","margin-left","max-height","max-width","min-height","min-width","orphans","outline","outline-color","outline-style","outline-width","overflow","padding","padding-top","padding-right","padding-bottom","padding-left","pause","position","right","size","table-layout","text-align","text-decoration","text-indent","text-shadow","text-transform","top","vertical-align","visibility","white-space","width","word-spacing","z-index","opacity","outline-offset","overflow-x","overflow-y"],AnimatorChain.prototype={setOptions:function(a){this.options=Animator.applyDefaults({resetOnPlay:!0},a)},play:function(){if(this.forwards=!0,this.current=-1,this.options.resetOnPlay)for(var a=0;a<this.animators.length;a++)this.animators[a].jumpTo(0);this.advance()},reverse:function(){if(this.forwards=!1,this.current=this.animators.length,this.options.resetOnPlay)for(var a=0;a<this.animators.length;a++)this.animators[a].jumpTo(1);this.advance()},toggle:function(){this.forwards?this.seekTo(0):this.seekTo(1)},listenTo:function(a){var b=a.options.onComplete,c=this;a.options.onComplete=function(){b&&b.call(a),c.advance()}},advance:function(){if(this.forwards){if(null==this.animators[this.current+1])return;this.current++,this.animators[this.current].play()}else{if(null==this.animators[this.current-1])return;this.current--,this.animators[this.current].reverse()}},seekTo:function(a){a<=0?(this.forwards=!1,this.animators[this.current].seekTo(0)):(this.forwards=!0,this.animators[this.current].seekTo(1))}},Accordion.prototype={setOptions:function(a){this.options=Object.extend({sections:null,getActivator:function(a){return document.getElementById(a.getAttribute("activator"))},shift:0,initialSection:0,rememberance:!0,animatorOptions:{}},a||{})},show:function(a){for(var b=0;b<this.ans.length;b++)this.ans[b].seekTo(b>a?1:0);this.options.rememberance&&(document.location.hash=this.rememberanceTexts[a])}};